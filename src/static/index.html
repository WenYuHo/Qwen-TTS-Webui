<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Qwen-TTS Podcast Studio</title>
    <link rel="stylesheet" href="/static/style.css">
</head>
<body>
    <div class="dashboard">
        <!-- Column 1: Speaker Library -->
        <div class="column">
            <div class="header">
                <h2>Speaker Library</h2>
                <a href="/static/studio.html" class="btn btn-secondary btn-sm" style="text-decoration:none">Studio</a>
            </div>
            <div class="scroll-area" id="speakers-list">
                <!-- Dynamic cards -->
            </div>
            <div style="padding: 20px; border-top: 1px solid var(--border);">
                <a href="/static/studio.html" class="btn btn-secondary" style="display:flex; width:100%; text-decoration:none">+ Create Voice</a>
            </div>
        </div>

        <!-- Column 2: Story Canvas -->
        <div class="column" style="flex: 2.5;">
            <div class="canvas-header">
                <h1>Story Canvas</h1>
                <div class="header-actions">
                    <select id="project-select" class="btn btn-secondary btn-sm" style="max-width: 140px;">
                        <option value="">(New Project)</option>
                    </select>
                    <button class="btn btn-secondary btn-sm" onclick="loadProject()">Load</button>
                    <button class="btn btn-secondary btn-sm" onclick="saveProject()">Save</button>
                    <div style="width:1px; background:var(--border); height:20px; margin:0 4px;"></div>
                    <button class="btn btn-secondary btn-sm" onclick="toggleView('draft')">Draft</button>
                    <button class="btn btn-secondary btn-sm" onclick="toggleView('prod')">Production</button>
                    <button class="btn btn-primary btn-sm" onclick="promoteToProduction()">Promote</button>
                </div>
            </div>

            <div id="draft-view" style="flex:1; display:flex; flex-direction:column;">
                <textarea id="script-editor" placeholder="[Ryan]: Hello! Write your script here..."></textarea>
            </div>

            <div id="prod-view" style="display:none; flex:1; flex-direction:column; overflow:hidden;">
                <!-- Timeline UI -->
                <div id="timeline-container" style="padding:20px; border-bottom:1px solid var(--border); background: rgba(0,0,0,0.1);">
                    <div id="waveform" style="margin-bottom: 10px; height: 100px;"></div>
                    <div id="waveform-timeline"></div>
                </div>

                <div id="blocks-container" class="scroll-area">
                    <!-- Dynamic Blocks -->
                </div>
            </div>

            <div style="margin-top: auto; padding: 20px; border-top: 1px solid var(--border); background: rgba(255,255,255,0.01);">
                <div style="display:flex; align-items:center; margin-bottom: 12px;">
                    <div id="heartbeat-dot" class="heartbeat-dot"></div>
                    <div class="status-msg" id="status-msg" style="font-size: 0.9rem; font-weight: 500;">Ready</div>
                </div>
                <audio id="audio-player" controls style="width: 100%; height: 40px;"></audio>
            </div>
        </div>

        <!-- Column 3: Production -->
        <div class="column">
            <div class="header">
                <h2>Production</h2>
            </div>
            <div class="scroll-area">
                <div class="control-group">
                    <span class="label">Atmospheric Mood</span>
                    <select class="btn btn-secondary" id="bgm-select" style="width:100%; text-align: left;">
                        <option value="">None (Voice Only)</option>
                        <option value="mystery">Ambient Mystery</option>
                        <option value="tech">Tech Newsroom</option>
                        <option value="joy">Joyful Morning</option>
                        <option value="rain">Soft Rain</option>
                    </select>
                </div>

                <div style="margin-top: 30px;">
                    <button class="btn btn-primary" id="generate-btn" onclick="generatePodcast()" style="width:100%; padding: 20px; font-weight: 700; font-size: 1rem;">
                        âš¡ PRODUCE FINAL PODCAST
                    </button>
                </div>

                <div class="control-group" style="margin-top: 24px;">
                    <span class="label">Shortcuts</span>
                    <button class="btn btn-secondary btn-sm" id="batch-btn" onclick="batchSynthesize()" style="width:100%; margin-bottom: 8px;">
                        Synthesize All Pending Blocks
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Scripts -->
    <script src="/static/libs/wavesurfer.min.js"></script>
    <script src="/static/libs/wavesurfer-regions.min.js"></script>
    <script src="/static/libs/wavesurfer-timeline.min.js"></script>
    <script src="/static/shared.js"></script>
    <script src="/static/timeline.js"></script>
    <script src="/static/app.js"></script>
</body>
</html>
